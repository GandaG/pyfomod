language: python

python:
    - 3.4
    - 3.5
    - 3.5-dev
    - &latest_py3 3.6
    - 3.6-dev
    - 3.7-dev
    - nightly

jobs:
    fast_finish: true
    allow_failures:
        - python: 3.7-dev
        - python: nightly
    include:
        - stage: Deploy
          if: tag IS present
          python: *latest_py3
          install:
              - pip install -U pip
              - pip install -r requirements.txt
          script: skip
          deploy:
              provider: pypi
              on:
                  tags: true
                  all_branches: true
              user: ganda
              password:
                  secure: TDKwzPDdFa/Bo1uir/Tz30kAcYBPWqCwuKCE6i34GOpnjJZNZpO0lPQY52PDi1I43YUfQ5xURfJbhDSscPIJvk63xyLo6LZ5i8GVKx4Ux6gxTkgRcAtd8ZszCIH0/mfSR2nNswudfoYYuLKSCowRqNBSyAZGbAPbIL++UxOoMZi7dTle+ExeOwFeS78tp6Vz8QvuxcRGdbG40H62cwastf407rbWa/TpCDwxn8tBLQU4zXT3jkwTqzWtUiwINXKpZ+GgzJe7IsMp9SzFrHO8d93ywDEXPltICEm5QqUS5z7h/3Wo6CHBLyF1Tfuk5Mnmm6MT6lN2RnyyfZfwvj+pbzobQOREfdOR2U3wUefaV1QlkxTW6R/UzHdmgv5eXV2RYDRRxq83yIPNxQukMTvlG+80vdNJFWRo8PgZR7kFxyyVRteWladTAWVkx73mzpKFdgZvWd/wb+a82ojYL5b8Odnavt3KOdyGhe2TxAvzq1taDVt8nZbI7zxsCfIO7x0XyPiKSr+yhQ6dCPVyh++5cUyDuf3fe9qRzmv7hnp9lqE1QNWM4NXXO+5IWQqcomQ9UEDy5hoXfUcmrsIcROZBCuNqvvMfkxwn80if4U5GCXUKLAH/vlcziMXT7tcfLbwWNIOLwlgzmtECItPDbXdltkcQhcrYCwdg7/xqMSBTb4Y=
              distributions: "sdist bdist_wheel"
              skip_cleanup: true
              skip_upload_docs: true

install:
    - pip install -U pip
    - pip install -r requirements.txt

script: 
    - tox -e check,py

after_success:
    - coveralls
